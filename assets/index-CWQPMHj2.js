var T=Object.defineProperty;var P=(c,e,t)=>e in c?T(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var d=(c,e,t)=>P(c,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const _ of a.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&i(_)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();class n{constructor(e,t){d(this,"_x");d(this,"_y");this._x=e,this._y=t}get x(){return this._x}get y(){return this._y}get magnitude(){return Math.sqrt(this._x*this._x+this._y*this._y)}get unit(){return this.magnitude===0?n.zero():new n(this._x/this.magnitude,this._y/this.magnitude)}get xy(){return[this._x,this._y]}get direction(){return Math.atan2(this.y,this.x)}set(e){return this._x=e.x,this._y=e.y,this}add(e){return this._x+=e.x,this._y+=e.y,this}sub(e){return this._x-=e.x,this._y-=e.y,this}dot(e){return this._x*e.x+this._y*e.y}toZero(){return this._x=0,this._y=0,this}toUnit(){if(this.magnitude===0)return this.toZero();const e=this.magnitude;return this.scale(1/e),this}limit(e){return this.magnitude>e&&this.scale(e/this.magnitude),this}scale(e){return this._x*=e,this._y*=e,this}scaleTo(e){return this.toUnit().scale(e)}rotate(e){return this.set(n.createUnit(this.direction+e).scale(this.magnitude))}static zero(){return new n(0,0)}static copy(e){return new n(e.x,e.y)}static add(e,t){return n.copy(e).add(t)}static sub(e,t){return n.copy(e).sub(t)}static dot(e,t){return e.dot(t)}static scale(e,t){return n.copy(e).scale(t)}static rotate(e,t){return n.copy(e).rotate(t)}static createUnit(e){return new n(Math.cos(e),Math.sin(e))}static sum(e){const t=new n(0,0);return e.map(i=>{t.add(i)}),t}}function h(c,e){return Math.random()*(e-c)+c}const l=class l{constructor(e){d(this,"_position");this._position=e}get position(){return this._position}static init(e,t){this._worldWidth=e,this._worldHeight=t}static createRandom(e){for(let t=0;t<e;t++)l.create(new n(h(0,l._worldWidth),h(0,l._worldHeight)))}static create(e){this.obstacles.push(new l(e))}};d(l,"obstacles"),d(l,"_worldWidth"),d(l,"_worldHeight");let b=l;const o={fullscreen_width:!0,fullscreen_height:!0,width:100,height:900,init_boid_count:100,init_speed_min:2,init_speed_max:4,boid_render_radius:10,max_speed:4,max_acceleration:.2,separation_range:100,perception_range:100,perception_angle:Math.PI*2*12/12,alignment:1,cohesion:1,separation:1,noise:.05,noise_magnitude:.05,background_color:"#898AC4",background_stroke_color:"#819A91",background_stroke_width:10,boid_stroke_color:"#C0C9EE",boid_stroke_width:5,boid_fill_color:"#C0C9EE",set(c,e){o[c]=e}},u=class u{constructor(e,t){d(this,"_position");d(this,"_velocity");d(this,"_acceleration");d(this,"_neighbours");this._position=e,this._velocity=t,this._acceleration=n.zero()}get position(){return this._position}get velocity(){return this._velocity}get angle(){return this._velocity.direction}addAcceleration(e){this._acceleration.add(e)}tick(){this.flock(),this.update()}flock(){this._neighbours=this.findNeighbours();const e=this.alignment(),t=this.seperation(),i=this.cohesion();e.scale(o.alignment),t.scale(o.separation),i.scale(o.cohesion),this.addAcceleration(e.add(t).add(i))}update(){this.addNoise(),this._velocity.add(this._acceleration),this._velocity.limit(o.max_speed),this._position.add(this._velocity),this.checkBorder(),this._acceleration=n.zero()}checkBorder(){const e=this._position,t=u._worldWidth,i=u._worldHeight;e.x<0?e.add(new n(t,0)):e.x>t?e.add(new n(-t,0)):e.y<0?e.add(new n(0,i)):e.y>i&&e.add(new n(0,-i))}alignment(){const e=this._neighbours;if(e.length===0)return n.zero();const t=n.zero();return e.forEach(s=>{t.add(s.velocity)}),t.scale(1/e.length),t.scaleTo(o.max_speed),n.sub(t,this.velocity).limit(o.max_acceleration)}cohesion(){const e=this._neighbours;if(e.length===0)return n.zero();const t=n.zero();e.forEach(a=>{t.add(a.position)}),t.scale(1/e.length);const i=n.sub(t,this.position).scaleTo(o.max_speed);return n.sub(i,this.velocity).limit(o.max_acceleration)}seperation(){const e=this._neighbours,t=n.zero();let i=0;return e.forEach(a=>{this.distanceTo(a)<o.separation_range&&(i++,t.add(n.sub(this.position,a.position).scale(1/this.distanceTo(a))))}),i===0?n.zero():(t.scaleTo(o.max_speed),n.sub(t,this.velocity).limit(o.max_acceleration))}addNoise(){if(Math.random()<o.noise){const e=n.rotate(this._velocity,h(-o.noise_magnitude*Math.PI,o.noise_magnitude*Math.PI));this.addAcceleration(e.sub(this._velocity))}}findNeighbours(){return u.boids.filter(e=>{const t=Math.abs(this.velocity.direction-n.sub(e.position,this._position).direction);return this.distanceTo(e)<o.perception_range&&this!=e&&Math.min(t,Math.PI*2-t)<o.perception_angle/2})}distanceTo(e){return n.sub(this._position,e.position).magnitude}static init(e,t){this._worldWidth=e,this._worldHeight=t}static createRandom(e){for(let t=0;t<e;t++){const i=new n(h(0,u._worldWidth),h(0,u._worldHeight)),s=n.createUnit(h(0,Math.PI*2)).scale(h(o.init_speed_min,o.init_speed_max));u.create(i,s)}}static create(e,t){u.boids.push(new u(e,t))}static clear(){u.boids=[]}};d(u,"boids",[]),d(u,"_worldWidth"),d(u,"_worldHeight");let p=u;const y=class y{constructor(){}static init(){const e=document.querySelector("#control");document.querySelector("#canvas").addEventListener("click",r=>{p.create(new n(r.x,r.y),n.createUnit(h(0,Math.PI*2)).scale(h(o.init_speed_min,o.init_speed_max)))}),document.querySelector("#alignment").addEventListener("input",r=>{o.set("alignment",r.target.value),document.querySelector("#alignment_").innerHTML=Number(r.target.value).toFixed(2)}),document.querySelector("#separation").addEventListener("input",r=>{o.set("separation",r.target.value),document.querySelector("#separation_").innerHTML=Number(r.target.value).toFixed(2)}),document.querySelector("#cohesion").addEventListener("input",r=>{o.set("cohesion",r.target.value),document.querySelector("#cohesion_").innerHTML=Number(r.target.value).toFixed(2)}),document.querySelector("#clear").addEventListener("click",()=>{p.clear()});let f=10;document.querySelector("#spawn").addEventListener("click",()=>{p.createRandom(f)}),document.querySelector("#spawnInput").addEventListener("input",r=>{f=r.target.value}),document.querySelector("#maxSpeed").addEventListener("input",r=>{o.set("max_speed",r.target.value),document.querySelector("#maxSpeed_").innerHTML=Number(r.target.value).toFixed(2)}),document.querySelector("#maxForce").addEventListener("input",r=>{o.set("max_acceleration",r.target.value),document.querySelector("#maxForce_").innerHTML=Number(r.target.value).toFixed(2)}),document.querySelector("#noise").addEventListener("input",r=>{o.set("noise",r.target.value),document.querySelector("#noise_").innerHTML=Number(r.target.value*100).toFixed(0)}),document.querySelector("#noiseMag").addEventListener("input",r=>{o.set("noise_magnitude",r.target.value),document.querySelector("#noiseMag_").innerHTML=Number(r.target.value).toFixed(2)}),document.querySelector("#separationRange").addEventListener("input",r=>{o.set("separation_range",r.target.value)}),document.querySelector("#perceptionRange").addEventListener("input",r=>{o.set("perception_range",r.target.value)}),document.querySelector("#perceptionAngle").addEventListener("input",r=>{o.set("perception_angle",r.target.value),document.querySelector("#perceptionAngle_").innerHTML=Number(r.target.value).toFixed(2)});let x=!0;window.addEventListener("keydown",r=>{r.key===" "&&(y.paused=!0),r.key==="Shift"&&x&&(e.hidden=!e.hidden,x=!1)}),window.addEventListener("keyup",r=>{r.key===" "&&(y.paused=!1),r.key==="Shift"&&(x=!0)}),window.addEventListener("contextmenu",r=>{r.preventDefault()}),window.addEventListener("selectstart",r=>{r.preventDefault()})}};d(y,"paused",!1);let w=y;window.onload=()=>{const c=document.querySelector("#canvas"),e=o.fullscreen_width?window.innerWidth:o.width,t=o.fullscreen_height?window.innerHeight:o.height;c.width=e,c.height=t;const i=c.getContext("2d"),s=()=>{w.init(),p.init(e,t),b.init(e,t),p.createRandom(o.init_boid_count),i.lineJoin="round",i.lineCap="round"},a=()=>{f(),i.lineWidth=o.boid_stroke_width,i.strokeStyle=o.boid_stroke_color,i.fillStyle=o.boid_fill_color;const m=w.paused;p.boids.forEach(g=>{S(g),m||g.tick()}),requestAnimationFrame(a)},_=()=>{requestAnimationFrame(a)};s(),_();const f=()=>{i.beginPath(),i.moveTo(0,0),i.lineTo(e,0),i.lineTo(e,t),i.lineTo(0,t),i.closePath(),i.lineWidth=o.background_stroke_width,i.fillStyle=o.background_color,i.strokeStyle=o.background_stroke_color,i.fill(),i.stroke()},S=m=>{const g=m.position,L=m.velocity,k=o.boid_render_radius,v=n.scale(L.unit,k),q=n.add(g,v),M=n.add(g,n.rotate(v,Math.PI*5/6)),E=n.add(g,n.rotate(v,Math.PI*-5/6));i.beginPath(),i.moveTo(...q.xy),i.lineTo(...M.xy),i.lineTo(...E.xy),i.closePath(),i.stroke(),i.fill()}};
